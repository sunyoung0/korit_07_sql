# test
## 1과목
문항 번호 및 정답을 명시하여 작성해주세요.

1. 다음 중 관계형 데이터베이스 관리 시스템(RDBMS)의 주요 특징으로 볼 수 없는 것은? 4

(1) 데이터를 테이블(릴레이션) 형태로 저장한다. 

(2) 데이터 조작을 위해 SQL(Structured Query Language)을 사용한다. 

(3) 데이터 무결성 유지를 위해 무결성 제약 조건을 지원한다. 

(4) 데이터의 중복을 최소화하기 위해 비정규화(Denormalization) 원칙을 따른다.

 

2. 데이터베이스의 내부 데이터를 조작하기 위한 기능에 해당하는 SQL의 종류는? 2

(1) DDL (Data Definition Language) 

(2) DML (Data Manipulation Language) 

(3) DCL (Data Control Language) 

(4) TCL (Transaction Control Language)

 

3. 테이블의 구조를 정의하고 관리하는 SQL 명령어에 해당하는 것은? 4

(1) SELECT 

(2) INSERT 

(3) UPDATE 

(4) CREATE

 

4. 다음 중 데이터베이스 보안과 사용자 권한 관리에 주로 사용되는 SQL 명령어는? 1

(1) GRANT, REVOKE 

(2) COMMIT, ROLLBACK 

(3) TRUNCATE, DROP 

(4) INSERT, DELETE

 

5. SQL문의 실행 순서가 올바르게 나열된 것은? 2

(1) SELECT -> FROM -> WHERE -> GROUP BY -> HAVING -> ORDER BY 

(2) FROM -> WHERE -> GROUP BY -> HAVING -> SELECT -> ORDER BY 

(3) FROM -> WHERE -> SELECT -> GROUP BY -> HAVING -> ORDER BY 

(4) FROM -> SELECT -> WHERE -> GROUP BY -> HAVING -> ORDER BY

 

6. users 테이블에서 country 컬럼의 데이터 중 중복을 제외하고 개수를 세는 올바른 SQL문은? 3

(1) SELECT COUNT(country) FROM users; 

(2) SELECT COUNT(*) FROM users; 

(3) SELECT COUNT(DISTINCT country) FROM users; 

(4) SELECT COUNT(ALL country) FROM users;

 

7. products 테이블에서 price 컬럼의 평균값을 소수점 둘째 자리까지 반올림하여 출력하는 올바른 SQL문은? 4

(1) SELECT ROUND(price) FROM products; 

(2) SELECT ROUND(AVG(price), 2) FROM products; 

(3) SELECT AVG(ROUND(price)) FROM products; 

(4) SELECT ROUND(AVG(price), 3) FROM products;

 

8. users 테이블에서 created_at 컬럼의 값이 '2011-01'로 시작하는 모든 회원을 조회하는 SQL문은? 4

(1) SELECT * FROM users WHERE created_at = '2011-01%'; 

(2) SELECT * FROM users WHERE created_at LIKE '2011-01%'; 

(3) SELECT * FROM users WHERE created_at IN ('2011-01'); 

(4) SELECT * FROM users WHERE SUBSTR(created_at, 1, 7) = '2011-01';

 

9. products 테이블에서 price가 10 이상 30 이하인 제품을 조회할 때, 가장 효율적인 WHERE 절은? 2

(1) WHERE price >= 10 AND price <= 30 

(2) WHERE price BETWEEN 10 AND 30 

(3) WHERE price = 10 OR price = 30 

(4) WHERE price > 9 AND price < 31

 

10. users 테이블과 orders 테이블을 user_id를 기준으로 결합하여, 두 테이블 모두에 존재하는 데이터만 출력하는 JOIN 유형은? 1

(1) INNER JOIN 

(2) LEFT JOIN 

(3) RIGHT JOIN 

(4) CROSS JOIN

 

11. users 테이블의 모든 데이터와, orders 테이블에 매칭되는 데이터가 있을 경우에만 orders의 데이터를 함께 출력하는 JOIN 유형은? 3

(1) RIGHT JOIN 

(2) INNER JOIN 

(3) LEFT JOIN 

(4) CROSS JOIN

 

12. WHERE 절에 사용할 수 있는 집계 함수는? 4

(1) COUNT() 

(2) SUM() 

(3) AVG() 

(4) 모두 사용할 수 없다.

 

13. GROUP BY 절에 대한 설명으로 올바른 것은? 2

(1) SELECT 절보다 나중에 실행되어 집계 함수 결과에 조건을 건다. 

(2) WHERE 절보다 먼저 실행되어 테이블 데이터를 그룹으로 묶는다. 

(3) FROM 절보다 먼저 실행되어 필터링을 수행한다. 

(4) ORDER BY 절보다 나중에 실행되어 최종 정렬을 담당한다.

 

14. 두 쿼리의 결과 집합을 위아래로 결합할 때, 중복된 행을 제거하는 키워드는? 2

(1) JOIN (2) UNION (3) UNION ALL (4) INTERSECT

 

15. SELECT 절에서 단일 값을 반환하는 서브쿼리를 사용하여 새로운 컬럼을 추가하는 쿼리 유형은? 2

(1) Inline View (2) Scalar Subquery (3) WHERE Subquery (4) Correlated Subquery

 

16. FROM 절에서 서브쿼리 결과물을 마치 테이블처럼 사용하는 쿼리 유형은? 1

(1) Inline View (2) Scalar Subquery (3) WHERE Subquery (4) Correlated Subquery

 

17. products 테이블에 새로운 컬럼 category를 VARCHAR(50) 타입으로 추가하는 DDL문은? 2 

(1) CREATE TABLE products ADD category VARCHAR(50); 

(2) ALTER TABLE products ADD COLUMN category VARCHAR(50); 

(3) UPDATE TABLE products ADD category VARCHAR(50); 

(4) INSERT INTO products ADD category VARCHAR(50);

 

18. products 테이블에서 id가 1인 제품의 price를 20으로 변경하는 DML문은? 2

(1) INSERT INTO products SET price = 20 WHERE id = 1; 

(2) UPDATE products SET price = 20 WHERE id = 1; 

(3) DELETE FROM products SET price = 20 WHERE id = 1; 

(4) ALTER TABLE products CHANGE price = 20 WHERE id = 1;


19. users 테이블에서 city가 'Seoul'인 모든 행을 삭제하는 DML문은? 3

(1) ALTER TABLE users DROP WHERE city = 'Seoul'; 

(2) UPDATE users SET status = 'deleted' WHERE city = 'Seoul'; 

(3) DELETE FROM users WHERE city = 'Seoul'; 

(4) TRUNCATE TABLE users WHERE city = 'Seoul';

 

20. 다음 중 DCL(Data Control Language)에 해당하지 않는 명령어는? 3

(1) GRANT (2) REVOKE (3) CREATE USER (4) COMMIT

 

21. users 테이블에서 country가 'Korea'인 회원이 마케팅 수신 동의(is_marketing_agree = 1)를 한 회원 수를 세는 올바른 쿼리는? 3

(1) SELECT COUNT(*) FROM users WHERE country = 'Korea'; 

(2) SELECT COUNT(is_marketing_agree) FROM users WHERE is_marketing_agree = 1; 

(3) SELECT COUNT(*) FROM users WHERE country = 'Korea' AND is_marketing_agree = 1; 

(4) SELECT COUNT(*) FROM users GROUP BY country, is_marketing_agree;

 

22. orders 테이블에서 주문 날짜(order_date)가 '2015년 12월'에 해당하는 주문을 모두 조회하는 쿼리는? 3

(1) SELECT * FROM orders WHERE order_date LIKE '2015-12%'; 

(2) SELECT * FROM orders WHERE order_date = '2015-12'; 

(3) SELECT * FROM orders WHERE SUBSTR(order_date, 1, 7) = '2015-12'; 

(4) SELECT * FROM orders WHERE order_date BETWEEN '2015-12-01' AND '2015-12-31';

 

23. users 테이블에서 country가 'UK'거나 'USA'인 회원의 수를 조회하는 쿼리는? 2

(1) SELECT COUNT(*) FROM users WHERE country = 'UK' AND country = 'USA'; 

(2) SELECT COUNT(*) FROM users WHERE country IN ('UK', 'USA'); 

(3) SELECT COUNT(*) FROM users WHERE country LIKE 'UK' OR 'USA'; 

(4) SELECT COUNT(*) FROM users WHERE country = 'UK' OR 'USA';

 

24. products 테이블에서 price가 가장 비싼 제품의 이름을 조회하는 쿼리는? 3

(1) SELECT name FROM products ORDER BY price DESC; 

(2) SELECT name FROM products WHERE price = MAX(price); 

(3) SELECT name FROM products WHERE price = (SELECT MAX(price) FROM products); 

(4) SELECT name FROM products WHERE price >= (SELECT MAX(price) FROM products);

 

25. users 테이블에서 city 컬럼을 기준으로 그룹화하여, city별 회원 수를 구하는 쿼리는? 3

(1) SELECT COUNT(*) FROM users GROUP BY city; 

(2) SELECT city, COUNT(id) FROM users; 

(3) SELECT city, COUNT(id) FROM users GROUP BY city; 

(4) SELECT city, COUNT(id) FROM users ORDER BY city;

 

26. orders 테이블과 orderdetails 테이블을 결합하여, orders에는 있지만 orderdetails에 없는 주문 정보를 찾으려면 어떤 JOIN과 조건이 필요한가? 2

(1) INNER JOIN과 WHERE 절에 od.order_id IS NULL 

(2) LEFT JOIN과 WHERE 절에 od.order_id IS NULL 

(3) RIGHT JOIN과 WHERE 절에 o.id IS NULL 

(4) CROSS JOIN과 WHERE 절에 od.order_id IS NULL

 

27. users 테이블의 모든 행과 orders 테이블의 모든 행을 곱하여 가능한 모든 조합을 출력하는 JOIN은? 4

 (1) INNER JOIN (2) LEFT JOIN (3) RIGHT JOIN (4) CROSS JOIN

 

28. orders 테이블에서 order_date가 '2016-01-01'부터 '2016-01-31'까지인 주문 건수와 order_date가 '2015-08-01'부터 '2015-08-31'까지인 주문 건수를 각각 구하여 위아래로 합치는 쿼리는? 3

(1) SELECT COUNT(*) FROM orders WHERE order_date BETWEEN '2016-01-01' AND '2016-01-31' JOIN SELECT COUNT(*) FROM orders WHERE order_date BETWEEN '2015-08-01' AND '2015-08-31'; 

(2) SELECT COUNT(*) FROM orders WHERE order_date LIKE '2016-01%'; JOIN SELECT COUNT(*) FROM orders WHERE order_date LIKE '2015-08%'; 

(3) (SELECT COUNT(*) FROM orders WHERE order_date BETWEEN '2016-01-01' AND '2016-01-31') UNION ALL (SELECT COUNT(*) FROM orders WHERE order_date BETWEEN '2015-08-01' AND '2015-08-31');

(4) (SELECT COUNT(*) FROM orders WHERE order_date LIKE '2016-01%') UNION (SELECT COUNT(*) FROM orders WHERE order_date LIKE '2015-08%');

 

29. GROUP BY를 사용하여 그룹별로 집계한 결과에 조건을 설정하고 싶을 때 사용해야 하는 절은? 3

(1) WHERE (2) ON (3) HAVING (4) ORDER BY

 

30. 다음 중 데이터베이스에서 ALTER TABLE을 사용하여 수행할 수 없는 작업은? 4

(1) 기존 컬럼의 이름을 변경하는 것 (2) 새로운 컬럼을 추가하는 것 (3) 기존 테이블의 이름을 변경하는 것 (4) 특정 행의 데이터를 삭제하는 것


## 2과목
Part 1: DDL - 데이터베이스 및 테이블 정의 (15문제, 50점)
 

1. sql_finals라는 이름의 데이터베이스를 생성하시오. (1점)
```sql
CREATE DATABASE sql_finals
```

2. 앞서 생성한 sql_finals 데이터베이스를 사용하겠다고 지정하시오. (1점)
```sql
USE sql_finals
```

3. users 테이블을 생성하시오. 컬럼 정보는 다음과 같습니다. (5점)

id : 정수형(INT), 주 키(PRIMARY KEY), 자동 증가(AUTO_INCREMENT)

created_at : 문자열(VARCHAR(100))

username : 문자열(VARCHAR(100)), NULL을 허용하지 않음(NOT NULL)

phone : 문자열(VARCHAR(100))

country : 문자열(VARCHAR(50))

```sql
CREATE TABLE users (
	id INT AUTO_INCREMENT PRIMARY KEY,
	created_at VARCHAR(100),
	username VARCHAR(100) NOT NULL,
	phone VARCHAR(100),
	country VARCHAR(50)
);
```

4. users 테이블에 is_marketing_agree라는 이름의 정수형(INT) 컬럼을 추가하시오. (3점)
```sql
ALTER TABLE users ADD COLUMN is_marketing_agree INT;
```
 

5. users 테이블의 phone 컬럼명을 user_phone으로 변경하고, 자료형은 그대로 유지하시오. (3점)
```sql
ALTER TABLE users RENAME COLUMN phone TO user_phone;
```
 

6. users 테이블에서 created_at 컬럼을 삭제하시오. (3점)
```sql
ALTER TABLE users DROP COLUMN created_at;
```
 

7. products 테이블을 생성하시오. 컬럼 정보는 다음과 같습니다. (5점)

id : 정수형(INT), 주 키(PRIMARY KEY), 자동 증가(AUTO_INCREMENT)

name : 문자열(VARCHAR(255)), NULL을 허용하지 않음(NOT NULL)

price : 소수점(DECIMAL(10, 2)), NULL을 허용하지 않음(NOT NULL)

discount_price : 소수점(DECIMAL(10, 2)), NULL을 허용하지 않음(NOT NULL)
```sql
CREATE TABLE products (
	id INT AUTO_INCREMENT PRIMARY KEY,
	name VARCHAR(255) NOT NULL,
	price DECIMAL(10,2) NOT NULL,
	discount_price DECIMAL(10,2) NOT NULL
);
```
 

8. products 테이블의 name 컬럼의 자료형을 VARCHAR(500)으로 변경하시오. (3점)
```sql
ALTER TABLE products MODIFY name VARCHAR(500);
```
 

9. staff 테이블을 생성하시오. 컬럼 정보는 다음과 같습니다. (5점)

id : 정수형(INT), 주 키(PRIMARY KEY), 자동 증가(AUTO_INCREMENT)

user_id : 정수형(INT), NULL을 허용하지 않음(NOT NULL)

last_name : 문자열(VARCHAR(50)), NULL을 허용하지 않음(NOT NULL)

first_name : 문자열(VARCHAR(50)), NULL을 허용하지 않음(NOT NULL)

birth_date : 날짜형(DATE)

```sql
CREATE TABLE staff (
	id INT AUTO_INCREMENT PRIMARY KEY,
	user_id INT NOT NULL,
	last_name VARCHAR(50) NOT NULL,
	first_name VARCHAR(50) NOT NULL,
	birth_date DATE
);
```

10. orders 테이블을 생성하시오. user_id와 staff_id에 외래 키(FOREIGN KEY) 제약 조건을 추가하시오. (5점)

id : 정수형(INT), 주 키(PRIMARY KEY), 자동 증가(AUTO_INCREMENT)

user_id : 정수형(INT)

staff_id : 정수형(INT)

order_date : 날짜형(DATE)
```sql
CREATE TABLE orders (
	id INT AUTO_INCREMENT PRIMARY KEY,
	user_id INT,
	staff_id INT,
	order_date DATE,
	FOREIGN KEY (user_id) REFERENCES users (id),
	FOREIGN KEY (staff_id) REFERENCES staff (id)
);
```


11. orderdetails 테이블을 생성하시오. order_id와 product_id에 외래 키(FOREIGN KEY) 제약 조건을 추가하시오. (5점)

id : 정수형(INT), 주 키(PRIMARY KEY), 자동 증가(AUTO_INCREMENT)

order_id : 정수형(INT)

product_id : 정수형(INT)

quantity : 정수형(INT), NULL을 허용하지 않음(NOT NULL)

```sql
CREATE TABLE orderdetails (
	id INT AUTO_INCREMENT PRIMARY KEY,
	order_id INT,
	product_id INT,
	quantity INT NOT NULL,
	FOREIGN KEY (order_id) REFERENCES orders(id),
	FOREIGN KEY (product_id) REFERENCES products(id)
);
```

12. users 테이블에서 is_marketing_agree 컬럼을 삭제하시오. (3점)
```sql
ALTER TABLE users DROP COLUMN is_marketing_agree;
```
 

13. orderdetails 테이블의 quantity 컬럼명을 amount로 변경하시오. (3점)
```sql
ALTER TABLE orderdetails RENAME COLUMN quantity TO amount;
```
 

14. orderdetails 테이블을 삭제하시오. (1점)
```sql
DROP TABLE orderdetails;
```
 

15. sql_finals 데이터베이스를 삭제하시오. (1점)
```sql
DROP DATABASE sql_finals;
```
 

Part 2: DML - 데이터 삽입, 수정, 삭제 (15문제, 50점)
 

※ 모든 문제는 Part 1의 3, 7, 9, 10, 11번 문제에서 생성한 테이블들이 존재한다고 가정하고 작성하시오.

1. users 테이블에 다음 데이터를 한 번에 삽입하시오. (5점)

'joejoe@joecompany.com', '010-1234-5678', 'Seoul', 'Korea'

'phk4938@never.com', '010-9876-5432', 'Buenos Aires', 'Argentina'
```sql
INSERT INTO users (username, phone, city, country) VALUES 
('joejoe@joecompany.com', '010-1234-5678', 'Seoul', 'Korea'), 
('phk4938@never.com', '010-9876-5432', 'Buenos Aires', 'Argentina');
```
 

2. users 테이블에 다음 데이터를 한 번에 삽입하시오. (5점)

'inr01@never.com', '010-1111-2222', 'New York', 'USA'

'fuxp76@never.com', '010-3333-4444', 'Seoul', 'Korea'

```sql
INSERT INTO users (username, phone, city, country) VALUES 
('inr01@never.com', '010-1111-2222', 'New York', 'USA'), 
('fuxp76@never.com', '010-3333-4444', 'Seoul', 'Korea');
```

3. products 테이블에 다음 제품 정보를 삽입하시오. (5점)

name: 'Terrarossa Coffee Back', price: 18.00, discount_price: 15.00
```sql
INSERT INTO products (NAME, price, discount_price) VALUES 
('Terrarossa Coffee Back', 18.00, 15.00);
```
 

4. products 테이블에 다음 제품 정보를 삽입하시오. (5점)

name: 'Mini Cheese Ball', price: 19.00, discount_price: 19.00

name: 'Stabucks Drip Coffee', price: 22.00, discount_price: 22.00

```sql
INSERT INTO products (NAME, price, discount_price) VALUES 
('Mini Cheese Ball', 19.00, 19.00),
('Stabucks Drip Coffee', 22.00, 22.00);
```

5. staff 테이블에 다음 데이터를 한 번에 삽입하시오. (5점)

user_id: 2, last_name: 'Carter', first_name: 'Joe', birth_date: '1990-10-20'

user_id: 10, last_name: 'Jang', first_name: 'Ken', birth_date: '1991-02-19'
```sql
INSERT INTO staff (user_id, last_name, first_name, birth_date) VALUES
(2, 'Carter', 'Joe', '1990-10-20'),
(10, 'Jang', 'Ken', '1991-02-19');
```

6. orders 테이블에 다음 데이터를 삽입하시오. (5점)

user_id: 2, staff_id: 1, order_date: '2025-09-18'
```sql
INSERT INTO orders (user_id, staff_id, order_date) VALUES
(2, 1, '2025-09-18');
```

7. orderdetails 테이블에 다음 데이터를 삽입하시오. (5점)

order_id: 1, product_id: 1, quantity: 2

order_id: 1, product_id: 2, quantity: 3

```sql
INSERT INTO orderdetails (order_id,product_id, quantity) VALUES
(1, 1, 2), (1, 2, 3);
```

8. users 테이블에서 username이 'inr01@never.com'인 회원의 phone 번호를 '010-5555-6666'으로 수정하시오. (3점)
```sql
UPDATE users
SET phone = '010-5555-6666'
WHERE username = 'inr01@never.com';
```
 

9. products 테이블에서 name이 'Mini Cheese Ball'인 제품의 price를 20.00으로 수정하시오. (3점)
```sql
UPDATE products
SET price = 20.00
WHERE name = 'Mini Cheese Ball';
```
 

10. staff 테이블에서 user_id가 10인 직원의 first_name을 'Minjun'으로 수정하시오. (3점)
```sql
UPDATE staff
SET first_name = 'Minjun'
WHERE user_id = 10;
```
 

11. users 테이블에서 username이 'phk4938@never.com'인 회원의 정보를 삭제하시오. (3점)
```sql
DELETE FROM users 
WHERE username = 'phk4938@never.com' ;
```
 

12. products 테이블에서 id가 3번인 제품을 삭제하시오. (3점)
```sql
DELETE FROM products
WHERE id = 3 ;
```
 

13. orderdetails 테이블에서 order_id가 1인 모든 데이터를 삭제하시오. (3점)
```sql
DELETE FROM orderdetails
WHERE order_id = 1;
```
 

14. users 테이블의 모든 데이터를 삭제하시오. (1점)
```sql
DELETE FROM users;
```
 

15. orders 테이블에서 order_date가 '2025-09-18'인 주문을 삭제하시오. (1점)
```sql
DELETE FROM orders
WHERE order_date = '2025-09-18';
```

Part 3: DML - 데이터 조회 (20문제, 100점)
 

※ 모든 문제는 사용자에게 제공된 CSV 파일의 데이터가 테이블에 모두 들어있다고 가정하고 작성하시오.

1. users 테이블에서 id, username, phone 컬럼을 모두 조회하시오. (5점)
```sql
SELECT id, username, phone FROM users;
```
 

2. orders 테이블에서 2015년에 주문된 모든 주문의 수를 세시오. (5점)
```sql
SELECT SUBSTR(order_date, 1, 4) AS year, COUNT(id) AS orderCnt FROM orders WHERE order_date BETWEEN '2015-01-01' AND '2015-12-31';
```
 

3. products 테이블에서 price가 가장 비싼 제품의 name을 조회하시오. (5점)
```sql
SELECT NAME
FROM products
WHERE price = (SELECT MAX(price) FROM products);
```
 

4. users 테이블에서 country가 'Korea'인 회원들의 id와 username을 조회하시오. (5점)
```sql
SELECT id, username FROM users WHERE country = 'Korea';
```
 
5. staff 테이블에서 birth_date가 1960년 1월 1일 이전인 직원의 last_name과 first_name을 조회하시오. (5점)
```sql
SELECT last_name, first_name FROM staff WHERE birth_date < '1960-01-01'
```
 

6. orders 테이블에서 user_id가 20인 회원이 주문한 모든 주문의 id와 order_date를 조회하시오. (5점)
```sql
SELECT id, order_date FROM orders WHERE user_id = 20;
```
 

7. orderdetails 테이블에서 product_id가 17번인 제품의 총 quantity를 계산하시오. (5점)
```sql
SELECT product_id, SUM(quantity) FROM orderdetails WHERE product_id = 17;
```
 

8. products 테이블에서 price의 평균값을 소수점 둘째 자리까지 반올림하여 조회하시오. (5점)
```sql
SELECT ROUND(AVG(price),3) FROM products
```
 

9. users 테이블에서 country별 회원 수를 계산하고, 회원 수가 5명 이상인 국가만 출력하시오. (5점)
```sql
SELECT country, COUNT(id) AS userCnt FROM users GROUP BY country HAVING userCnt > 4;
```
 

10. orders 테이블에서 staff_id별 주문 건수를 계산하고, 주문 건수가 가장 많은 직원부터 순서대로 staff_id와 주문 건수를 출력하시오. (5점)
```sql
SELECT staff_id, COUNT(id) AS orderCnt FROM orders GROUP BY staff_id ORDER BY orderCnt DESC;
```
 

11. users와 orders 테이블을 결합하여, 각 회원(users.id)별 주문 건수를 계산하고, 주문 건수가 2건 이상인 회원의 username과 주문 건수를 출력하시오. (10점)
```sql
SELECT u.username, COUNT(o.id) AS orderCnt 
FROM users u LEFT JOIN orders o ON u.id = o.user_id
GROUP BY u.id
HAVING orderCnt > 1; 
```
 

12. users와 staff 테이블을 결합하여, 직원인 회원의 id, username, last_name, first_name을 조회하시오. (5점)
```sql
SELECT u.id, u.username, s.last_name, s.first_name
FROM users u INNER JOIN staff s 
ON u.id = s.user_id;
```
 

13. orders와 orderdetails 테이블을 결합하여, 각 주문(orders.id)별 총 주문 수량의 합계를 계산하고, 총 수량이 100 초과인 주문의 order_id와 총 수량을 출력하시오. (10점)
```sql
SELECT o.id, SUM(quantity) AS orderSum
FROM orders o INNER JOIN orderdetails od ON o.id = od.order_id
GROUP BY o.id
HAVING orderSum > 100
ORDER BY orderSum;
```
 

14. orders와 users 테이블을 결합하여, country가 'USA'인 회원들이 주문한 총 건수를 계산하시오. (10점)
```sql
SELECT country, COUNT(o.id)
FROM (SELECT * FROM users WHERE country = 'USA') u
INNER JOIN orders o
ON u.id = o.user_id
GROUP BY country;
```
 

15. orders 테이블에서 주문 날짜가 2015년 12월이면서 staff_id가 3번인 직원이 담당한 주문 건수를 조회하시오. (5점)
```sql
SELECT staff_id, COUNT(id) FROM orders
WHERE order_date BETWEEN '2015-12-01' AND '2015-12-31' AND staff_id = 3
GROUP BY staff_id;
```
 

16. products 테이블에서 price가 products 테이블의 평균 price보다 높은 제품의 name과 price를 조회하시오. (10점)
```sql
SELECT NAME, price
FROM products
WHERE price > (SELECT AVG(price) FROM products)
ORDER BY price;
```
 

17. users 테이블에서 city별 회원 수를 계산하고, city가 'Seoul'인 회원의 수를 조회하시오. (5점)
```sql
SELECT city, COUNT(id) AS userCnt FROM users 
WHERE city = 'Seoul'
GROUP BY city;
```
 

18. orders, orderdetails, products 테이블을 결합하여, 각 주문(orders.id)별 총 주문 금액(제품 가격(price) * 수량(quantity))을 계산하고, 주문 금액이 2000 이상인 주문의 order_id와 총 금액을 출력하시오. (15점)
```sql
SELECT o.id, SUM((p.price) * (od.quantity)) AS totalPrice 
FROM orders o 
INNER JOIN orderdetails od ON o.id = od.order_id
INNER JOIN products p ON od.product_id = p.id
GROUP BY o.id
HAVING totalPrice >= 2000
ORDER BY totalPrice;
```

19. products 테이블에서 name에 'Coffee'가 포함된 제품의 name과 price를 조회하시오. (5점)
```sql
SELECT name, price FROM products WHERE name LIKE '%Coffee%';
```
 
20. staff 테이블에서 birth_date가 1960년 이전인 직원과 1990년 이후인 직원의 last_name과 first_name을 UNION으로 합쳐서 조회하시오. (10점)
```sql
(SELECT last_name, first_name FROM staff WHERE birth_date < '1960-01-01')
UNION
(SELECT last_name, first_name FROM staff WHERE birth_date > '1990-12-31');
```